class FormTemporary{constructor(a){this.selector=a,this.element=document.querySelector(a),this.url=window.location.href,this.field_items=["text","date","time","range","number","email","password","select","radio","checkbox","textarea"],this.delay=!0,this.delayDuration=1e3}record(a){a&&(void 0!==a.allows&&this.setAllows(a.allows),void 0!==a.ignore&&this.setIgnore(a.ignore),void 0!==a.delay&&(this.delay=a.delay),void 0!==a.delayDuration&&(this.delayDuration=a.delayDuration));var b=this;this.setTemporary(),this.startRecord(),this.makeLocalStorage(),this.element.onsubmit=function(){window.onbeforeunload=function(){b.clear()}}}setAllows(b){for(var c=this.field_items,a=0;a<b.length;a++)c.includes(b[a])||c.push(b[a]);this.field_items=c}setIgnore(c){for(var a=this.field_items,b=0;b<c.length;b++)if(a.includes(c[b])){var d=a.indexOf(c[b]);a.splice(d,1)}this.field_items=a}makeLocalStorage(){var a=localStorage.getItem("save-temporary"),c=this;if(a){a=JSON.parse(a);var b=!1;a.forEach(function(a,d){a.url==c.url&&a.selector==c.selector&&(b=!0)}),b||a.push({url:this.url,selector:this.selector,values:[]})}else var a=[{url:this.url,selector:this.selector,values:[]}];localStorage.setItem("save-temporary",JSON.stringify(a))}setTemporary(){var d=this.element,c=localStorage.getItem("save-temporary"),a=JSON.parse(c),e=this,b=[];a&&(a.forEach(function(a,c){a.url==e.url&&a.selector==e.selector&&(b=a.values)}),this.temporary=b,b.forEach(function(a,f){var b=["text","number","email","password","date","time","range"];if(b.includes(a.type)){if(Array.isArray(a.value)){var c=d.querySelectorAll("*[type='"+a.type+"'][name='"+a.name+"']");c.forEach(function(b,c){e.delay?(b.value="...",setTimeout(function(){b.value=a.value[c]},e.delayDuration)):b.value=a.value[c]})}else{var b=d.querySelectorAll("*[type='"+a.type+"'][name='"+a.name+"']");b.forEach(function(b,c){e.delay?(b.value="...",setTimeout(function(){b.value=a.value},e.delayDuration)):b.value=a.value})}}if("radio"==a.type&&(e.delay?setTimeout(function(){d.querySelector("*[type='"+a.type+"'][name='"+a.name+"'][value='"+a.value+"']").setAttribute("checked","checked")},e.delayDuration):d.querySelector("*[type='"+a.type+"'][name='"+a.name+"'][value='"+a.value+"']").setAttribute("checked","checked")),"checkbox"==a.type&&(Array.isArray(a.value)?a.value.forEach(function(b,c){e.delay?setTimeout(function(){d.querySelector("*[type='"+a.type+"'][name='"+a.name+"'][value='"+b+"']").setAttribute("checked","checked")},e.delayDuration):d.querySelector("*[type='"+a.type+"'][name='"+a.name+"'][value='"+b+"']").setAttribute("checked","checked")}):d.querySelectorAll("*[type='"+a.type+"'][name='"+a.name+"'][value='"+a.value+"']").forEach(function(a,b){e.delay?setTimeout(function(){a.setAttribute("checked","checked")},e.delayDuration):a.setAttribute("checked","checked")})),"textarea"==a.type){if(Array.isArray(a.value)){var c=d.querySelectorAll("textarea[name='"+a.name+"']");c.forEach(function(b,c){e.delay?(b.value="...",setTimeout(function(){b.value=a.value[c]},e.delayDuration)):b.value=a.value[c]})}else{var b=d.querySelectorAll("textarea[name='"+a.name+"']");b.forEach(function(b,c){e.delay?(b.value="...",setTimeout(function(){b.value=a.value},e.delayDuration)):b.value=a.value})}}"select"==a.type&&(Array.isArray(a.value)?d.querySelectorAll("select[name='"+a.name+"']").forEach(function(b,d){if(e.delay)setTimeout(function(){for(var c of b.options)a.value.includes(c.value)&&c.setAttribute("selected","selected");b.dispatchEvent(new Event("change"))},e.delayDuration);else{for(var c of b.options)a.value.includes(c.value)&&c.setAttribute("selected","selected");b.dispatchEvent(new Event("change"))}}):d.querySelectorAll("select[name='"+a.name+"']").forEach(function(b,c){e.delay?setTimeout(function(){b.value=a.value,b.dispatchEvent(new Event("change"))},e.delayDuration):(b.value=a.value,b.dispatchEvent(new Event("change")))}))}))}getTemporary(){return this.temporary}clear(){var b=localStorage.getItem("save-temporary"),a=JSON.parse(b),c=this;a.forEach(function(b,d){b.url==c.url&&b.selector==c.selector&&(a[d].values=[])}),localStorage.setItem("save-temporary",JSON.stringify(a))}startRecord(){var a=this.element,b=this;this.field_items.forEach(function(c,g){if(["text","number","email","password","radio","checkbox","date","time","range"].includes(c)){var d=a.querySelectorAll("*[type='"+c+"']");d.length>0&&d.forEach(function(d,e){d.addEventListener("change",e=>{var d=e.target.getAttribute("name");if(d.includes("[")){var f=[];if("checkbox"==c)var g=a.querySelectorAll("*[type='"+c+"'][name='"+d+"']:checked");else var g=a.querySelectorAll("*[type='"+c+"'][name='"+d+"']");g.forEach(function(a,b){f.push(a.value)})}else var f=e.target.value;c&&d&&b.saveRecord(c,d,f)})})}if("select"==c){var e=a.querySelectorAll("select");e.length>0&&e.forEach(function(c,d){c.addEventListener("change",d=>{var c=d.target.getAttribute("name");if(c.includes("[")){var e=[];a.querySelectorAll("select[name='"+c+"']").forEach(function(b,c){for(var a of b.options)a.selected&&e.push(a.value)})}else var e=d.target.value;c&&b.saveRecord("select",c,e)})})}if("textarea"==c){var f=a.querySelectorAll("textarea");f.length>0&&f.forEach(function(c,d){c.addEventListener("change",d=>{var c=d.target.getAttribute("name");if(c.includes("[")){var e=[];a.querySelectorAll("textarea[name='"+c+"']").forEach(function(a,b){e.push(a.value)})}else var e=d.target.value;c&&b.saveRecord("textarea",c,e)})})}})}saveRecord(c,d,e){var b=localStorage.getItem("save-temporary"),a=JSON.parse(b),f=this;a.forEach(function(g,b){if(g.url==f.url&&g.selector==f.selector){var i=a[b].values,h=-1;i.forEach(function(a,b){a.name==d&&a.type==c&&(h=b)}),h> -1?a[b].values[h]={type:c,name:d,value:e}:a[b].values.push({type:c,name:d,value:e})}}),localStorage.setItem("save-temporary",JSON.stringify(a))}}